---
title: "Assignment F"
format: 
  pdf: default
editor: visual
---




```{r}
library(tidyverse)
df<- read_csv("strawberry raw.csv")
str(df)
df<- df %>% 
  select(where(~!all(is.na(.)))) |> #delete columns with all NA
  select(where(~ n_distinct(.,na.rm = TRUE)>1) ) |>#delete columns with single value, which means no information provided in comparing
  mutate(Year = as.integer(Year),
         Value = str_replace_all(Value, ",", ""),
         Value = as.numeric(Value),
         State = as.factor(State),
         Domain = as.factor(Domain),
         `Domain Category` = as.factor(`Domain Category`)) 
other<- df|> #find those use other chemicals
  filter(Domain == "CHEMICAL, OTHER")
other_che<- other|> #inside the other chemical, group by different other chemicals
  group_by(`Domain Category`)|>
  summarise(mean_value = mean(Value, na.rm = TRUE),
            sd_value = sd(Value, na.rm = TRUE),
            n=n())
view(other_che)
ggplot(other_che,
       aes(x = reorder(`Domain Category`, n),
           y = n)) +
  geom_col() +
  coord_flip() +
  labs(
    title = "Number of Records per Other Chemical Category",
    x = "Other Chemical Category",
    y = "Count (n)") +
  theme_minimal()
df<- df|> #detect whether it's conventional or organic
  mutate(type = case_when(
    str_detect(Domain,"CHEMICAL") ~ "Conventional",
    !str_detect(Domain,"CHEMICAL") ~ "Organic"
  )
  )
organic_vs_convention<- df|>
  group_by(State, type)|>
  summarise(
    mean_value = mean(Value, na.rm = TRUE),
    sd_value = sd(Value, na.rm = TRUE),
    n = n()
  ) |>
  arrange(mean_value)
ggplot(organic_vs_convention,aes(State,mean_value,fill = type))+
  geom_col(position = "dodge")+
  coord_flip()+
  labs(title = "mean_value between conventional and organic in differenct states",
       x = "state",
       y= "mean value")+
  theme_minimal()
ggplot(df, aes(type, Value,fill = type))+
  geom_boxplot() +
  theme_minimal()



```

##Raw data acquisition #The raw strawberry dataset used in this analysis was obtained from the United States Department of Agriculture (USDA) National Agricultural Statistics Service (NASS), which provides publicly available agricultural data. #Specifically, the data were downloaded from the NASS Quick Stats database (https://quickstats.nass.usda.gov/) Data retrieved: October 2025 Citation:U.S. Department of Agriculture, National Agricultural Statistics Service (NASS). Quick Stats Database. https://quickstats.nass.usda.gov/
